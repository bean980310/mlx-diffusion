import math
from typing import List, Optional, Tuple, Union

import numpy as np
import torch
import torch.nn.functional as F

import mlx.core as mx
import mlx.nn as nn
import mlx.nn.layers as nn_layers